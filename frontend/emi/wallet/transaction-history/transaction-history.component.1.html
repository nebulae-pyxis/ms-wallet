<div id="user" class="page-layout carded fullwidth" fusePerfectScrollbar>


    <!-- TOP BACKGROUND -->
    <div class="top-bg mat-accent-bg"></div>
    <!-- / TOP BACKGROUND -->


  <!-- CENTER -->
  <div class="center">

      <div class="header white-fg" fxLayout="row" fxLayoutAlign="start center" *ngIf="isSystemAdmin">
          <!-- APP TITLE -->
          <div class="logo my-12 m-sm-0" fxLayout="row" fxLayoutAlign="start start" fxFlex="60">
            <mat-icon class="logo-icon mr-16" *fuseIfOnDom [@animate]="{value:'*',params:{delay:'50ms',scale:'0.2'}}">book</mat-icon>
            <span class="logo-text h1" *fuseIfOnDom [@animate]="{value:'*',params:{delay:'100ms',x:'-25px'}}">{{'WALLET.TRANSACTION_HISTORY'
              | translate}}</span>
          </div>
          <!-- / APP TITLE -->
          <!-- BUSINESS FILTER -->
          <div fxLayout="column" fxLayout.gt-sm="row" fxLayoutAlign="start start" fxFlex="40">
            <div class="search-input-wrapper mx-12 m-md-0" fxFlex="1 0 auto" fxLayout="row" fxLayoutAlign="start center">
              <label for="search" style="margin-bottom: 10px" class="mr-20">
                <span class="mat-title">{{'WALLET.BUSINESS' | translate}}</span>
              </label>
              <form name="businessForm" fxFlex>
                <mat-form-field class="w-100-p">
                  <mat-select placeholder="{{'WALLET.SELECT_BUSINESS' | translate}}" [(value)]="selectedBusinessData"
                    (selectionChange)="onSelectBusinessEvent($event.value)">
      
                    <mat-option *ngFor="let business of allBusiness" [value]="business">
                      {{business.name}} - {{business._id}}
                    </mat-option>
      
                  </mat-select>
                </mat-form-field>
              </form>
            </div>
          </div>
          <!-- / BUSINESS FILTER -->
      </div>

      <div class="header white-fg" fxLayout="row" fxLayoutAlign="start center" *ngIf="!isSystemAdmin">
          <!-- APP TITLE -->
          <div fxLayout="row" fxLayoutAlign="start center">
      
            <div fxLayout="column" fxLayoutAlign="start start" *fuseIfOnDom>
      
              <label for="search" style="margin-bottom: 10px" fxLayoutAlign="space-between start" class="mr-20">
                <mat-icon class="logo-icon mr-16" *fuseIfOnDom [@animate]="{value:'*',params:{delay:'50ms',scale:'0.2'}}">book</mat-icon>
                <span class="mat-title">{{'WALLET.TRANSACTION_HISTORY' | translate}}</span>
              </label>
              <div class="subtitle" *ngIf="selectedBusinessData">
                {{selectedBusinessData.name}}
              </div>
      
              <div class="subtitle secondary-text">
                <span>{{'WALLET.TRANSACTION_HISTORY' | translate}} {{myBusiness.name}}({{myBusiness._id}})</span>
              </div>
            </div>
          </div>
          <!-- / APP TITLE -->
      </div>

    <div class="header white-fg" fxLayout="row" fxFlex="100" fxLayoutWrap [@animateStagger]="{value:'50'}"
      *ngIf="false">
      <!-- WALLET WIDGET -->
      <fuse-widget [@animate]="{value:'*',params:{y:'100%'}}" class="widget" fxLayout="column" fxFlex="20">

        <!-- Front -->
        <div class="fuse-widget-front mat-white-bg mat-elevation-z2">
          <div class="px-16 py-8 border-bottom" fxLayout="row" fxLayoutAlign="start center">
            <mat-icon class="logo-icon mr-16" *fuseIfOnDom [@animate]="{value:'*',params:{delay:'50ms',scale:'0.2'}}">money</mat-icon>
            <div class="h3">Wallet</div>
          </div>

          <div fxLayout="column" fxLayoutAlign="start start">


            <div class="px-16 py-12" fxLayout="column" fxLayoutAlign="center" fxLayout.gt-xs="row" fxLayoutAlign.gt-xs="space-between end">
              <div fxFlex="0 1 auto">
                <div class="h4 secondary-text">Balance</div>
                <div class="pt-0 mat-headline m-0 font-weight-300 text-nowrap">
                  <span>{{ walletData.pockets.balance | currency}}</span>
                </div>
              </div>

              <div class="h-52" fxFlex>

              </div>
            </div>

            <div class="px-16 py-12" fxLayout="column" fxLayoutAlign="center" fxLayout.gt-xs="row" fxLayoutAlign.gt-xs="space-between end">
              <div fxFlex="0 1 auto">
                <div class="h4 secondary-text">Bonus</div>
                <div class="pt-0 mat-headline m-0 font-weight-300 text-nowrap">
                  <span>{{ walletData.pockets.bonus | currency}}</span>
                </div>
              </div>
              <div class="h-52" fxFlex>

              </div>
            </div>

            <div class="px-16 py-12" fxLayout="column" fxLayoutAlign="center" fxLayout.gt-xs="row" fxLayoutAlign.gt-xs="space-between end">
              <div fxFlex="0 1 auto">
                <div class="h4 secondary-text">Credit</div>
                <div class="pt-0 mat-headline m-0 font-weight-300 text-nowrap">
                  <span>{{ walletData.pockets.bonus | currency}}</span>
                </div>
              </div>
              <div class="h-52" fxFlex>

              </div>
            </div>


          </div>

        </div>
        <!-- / Front -->
      </fuse-widget>
      <!-- / WALLET WIDGET -->
    </div>

    <!-- CONTENT CARD -->

          <!-- CONTENT CARD -->

          <div class="content-card mat-white-bg">
  
              <div fxLayout="column" style="width: 100%; justify-content: space-between" fxLayout.gt-sm="row">
                <div fxLayout="column" fxFlex="100" fxFlex.gt-sm="100" fxFlex.gt-md="100">
                  
                  <div fxLayout="column">








                      <mat-expansion-panel fxFlex="100" [expanded]="true">
                          <mat-expansion-panel-header>
                            <mat-panel-title fxFlex="100">
                              <div fxLayout="row" fxFlex="100"  fxLayoutAlign="start center">
                                  <mat-icon class="mr-8">money</mat-icon>
                                  <div class="h3 mb-0">{{'WALLET.WALLET' | translate}}</div>                                
                                  
                              </div>                                                            
                            </mat-panel-title>
                            <mat-panel-description>
                                <div>

                                </div>
                            </mat-panel-description>
                          </mat-expansion-panel-header>
                          
                          <div>

                              <div fxLayout="column" fxLayoutAlign="center start">
  
                                  <div class="px-16 py-12" fxLayout="column" fxLayoutAlign="center" fxLayout.gt-xs="row" fxLayoutAlign.gt-xs="space-between end">
                                    <div fxFlex="0 1 auto">
                                      <div class="h4 secondary-text">Balance</div>
                                      <div class="pt-0 mat-headline m-0 font-weight-300 text-nowrap">
                                        <span>{{ walletData.pockets.balance | currency}}</span>
                                      </div>
                                    </div>
                                  </div>
                    
                                  <div class="px-16 py-12" fxLayout="column" fxLayoutAlign="center" fxLayout.gt-xs="row" fxLayoutAlign.gt-xs="space-between end">
                                    <div fxFlex="0 1 auto">
                                      <div class="h4 secondary-text">Bonus</div>
                                      <div class="pt-0 mat-headline m-0 font-weight-300 text-nowrap">
                                        <span>{{ walletData.pockets.bonus | currency}}</span>
                                      </div>
                                    </div>
                                  </div>
                    
                                  <div class="px-16 py-12" fxLayout="column" fxLayoutAlign="center" fxLayout.gt-xs="row" fxLayoutAlign.gt-xs="space-between end">
                                    <div fxFlex="0 1 auto">
                                      <div class="h4 secondary-text">Credit</div>
                                      <div class="pt-0 mat-headline m-0 font-weight-300 text-nowrap">
                                        <span>{{ walletData.pockets.bonus | currency}}</span>
                                      </div>
                                    </div>
                                  </div>
                    
                    
                                </div>
                            
                          </div>

                          
            
                        </mat-expansion-panel>






















                      <mat-expansion-panel fxFlex="100" [expanded]="true">
                          <mat-expansion-panel-header>
                            <mat-panel-title fxFlex="100">
                              <div fxLayout="row" fxFlex="100"  fxLayoutAlign="start center">
                                  <mat-icon class="mr-8">search</mat-icon>
                                  <div class="h3 mb-0">{{'WALLET.FILTER' | translate}}</div>                                
                                  
                              </div>                                                            
                            </mat-panel-title>
                            <mat-panel-description>
                                
                            </mat-panel-description>
                          </mat-expansion-panel-header>
                          
                          <div>

                              <form class="mat-white-bg p-8" fxLayout="column" fxLayoutAlign="start" fxFlex="100"
                              name="form" [formGroup]="filterForm">
                              
                              <div fxLayout="row" fxLayoutAlign="start center" fxFlex="1 0 auto">
                                <mat-form-field fxFlex="33" class="mr-8">
                                  <input matInput [matDatepicker]="pickerInitDate" placeholder="{{'WALLET.INIT_DATE' | translate}}" formControlName="initDate">
                                  <mat-datepicker-toggle matSuffix [for]="pickerInitDate"></mat-datepicker-toggle>
                                  <mat-datepicker type="datetime" touchUi="false" clockStep="5" #pickerInitDate></mat-datepicker>
                                </mat-form-field>
                
                
                                <mat-form-field fxFlex="33" class="mr-8">
                                    <input matInput [matDatepicker]="pickerEndDate" placeholder="{{'WALLET.END_DATE' | translate}}" formControlName="endDate">
                                    <mat-datepicker-toggle matSuffix [for]="pickerEndDate"></mat-datepicker-toggle>
                                    <mat-datepicker type="datetime" clockStep="5" #pickerEndDate></mat-datepicker>
                                </mat-form-field>
                
                              </div>
                
                              <div fxLayout="row" fxLayoutAlign="start center" fxFlex="1 0 auto">
                
                                <mat-form-field fxFlex="49" class="mr-8">
                                  <mat-select placeholder="{{'WALLET.SELECT_TRANSACTION_TYPE' | translate}}" formControlName="transactionType" id="transactionType">
                                      <mat-option>Clear</mat-option>
                                    <mat-option *ngFor="let transactionType of transactionTypes" [value]="transactionType">
                                      transactionType
                                    </mat-option>
                
                                  </mat-select>
                                </mat-form-field>
                
                                <mat-form-field fxFlex="49">
                                  <mat-select placeholder="{{'WALLET.SELECT_TRANSACTION_CONCEPT' | translate}}" formControlName="transactionConcept">
                
                                    <mat-option *ngFor="let transactionConcept of transactionConcepts" [value]="transactionConcept">
                                      transactionConcept
                                    </mat-option>
                
                                  </mat-select>
                                </mat-form-field>
                
                              </div>
                
                              <div fxLayout="row" fxLayoutAlign="start center" fxFlex="1 0 auto">
                
                                <mat-form-field fxFlex="33" class="mr-8">
                                  <input matInput placeholder="{{'WALLET.TERMINAL_ID' | translate}}" formControlName="terminalId" id="terminalId">
                                </mat-form-field>
                
                                <mat-form-field fxFlex="33" class="mr-8">
                                  <input matInput placeholder="{{'WALLET.TERMINAL_USER_ID' | translate}}" formControlName="terminalUserId" id="terminalUserId">
                                </mat-form-field>
                
                                <mat-form-field fxFlex="32">
                                  <input matInput placeholder="{{'WALLET.TERMINAL_USERNAME' | translate}}" formControlName="terminalUsername" id="terminalUsername">
                                </mat-form-field>
                
                              </div>
                              <button fxFlex="100" mat-raised-button mat-button color="warn" (click)="resetFilter()">{{'WALLET.RESET_FILTER' | translate}}</button>
                            </form>


        
                          </div>

                          
            
                        </mat-expansion-panel>

                  </div>
                    
                    <mat-table id="transaction-history-table" class="item-table" #table [dataSource]="dataSource">

                        <!-- Timestamp Column -->
                        <ng-container cdkColumnDef="timestamp">
                          <mat-header-cell *cdkHeaderCellDef>{{'WALLET.TIMESTAMP' | translate}}</mat-header-cell>
                          <mat-cell *cdkCellDef="let transaction">
                            <p class="text-truncate">{{transaction.timestamp | date: 'dd/MM/y HH:mm:ss'}}</p>
                          </mat-cell>
                        </ng-container>
                
                        <!-- From Column -->
                        <ng-container cdkColumnDef="type">
                          <mat-header-cell *cdkHeaderCellDef>{{'WALLET.TRANSACTION_TYPE' | translate}}</mat-header-cell>
                          <mat-cell *cdkCellDef="let transaction">
                            <p class="text-truncate">{{'WALLET.TYPES.'+transaction.type | translate}}</p>
                          </mat-cell>
                        </ng-container>
                
                        <!-- Concept Column -->
                        <ng-container cdkColumnDef="concept">
                          <mat-header-cell *cdkHeaderCellDef>{{'WALLET.TRANSACTION_CONCEPT' | translate}}</mat-header-cell>
                          <mat-cell *cdkCellDef="let transaction">
                            <p class="text-truncate">{{'WALLET.CONCEPTS.'+transaction.concept | translate}}</p>
                          </mat-cell>
                        </ng-container>
                
                        <!-- Value Column -->
                        <ng-container cdkColumnDef="value">
                          <mat-header-cell *cdkHeaderCellDef>{{'WALLET.TRANSACTION_VALUE' | translate}}</mat-header-cell>
                          <mat-cell *cdkCellDef="let transaction">
                            <p class="text-truncate">{{transaction.value | currency}}</p>
                          </mat-cell>
                        </ng-container>
                
                        <!-- Pocket Column -->
                        <ng-container cdkColumnDef="pocket">
                          <mat-header-cell *cdkHeaderCellDef>{{'WALLET.TRANSACTION_POCKET' | translate}}</mat-header-cell>
                          <mat-cell *cdkCellDef="let transaction">
                            <p class="text-truncate">{{'WALLET.'+transaction.pocket | translate}}</p>
                          </mat-cell>
                        </ng-container>
                
                        <!-- User Column -->
                        <ng-container cdkColumnDef="user">
                          <mat-header-cell *cdkHeaderCellDef>{{'WALLET.TRANSACTION_USER' | translate}}</mat-header-cell>
                          <mat-cell *cdkCellDef="let transaction">
                            <p class="text-truncate">{{transaction.user}}</p>
                          </mat-cell>
                        </ng-container>
                
                        <mat-header-row *cdkHeaderRowDef="displayedColumns"></mat-header-row>
                
                        <mat-row *cdkRowDef="let transaction; columns: displayedColumns;" class="transactions"
                        (click)="selectTransactionHistoryRow(transaction)" [ngClass]="{'highlight': selectedTransactionHistory && selectedTransactionHistory._id == transaction._id}"
                        [routerLink]="transaction._id" matRipple>
                        </mat-row>
                
                      </mat-table>
                
                      <mat-paginator #paginator [length]="tableSize" [pageIndex]="0" [pageSize]="10" [pageSizeOptions]="[5, 10, 25, 100]">
                      </mat-paginator>

                  
                </div>
              </div>
          </div>

    <!-- / CONTENT CARD -->
  </div>
  <!-- / CENTER -->
</div>
