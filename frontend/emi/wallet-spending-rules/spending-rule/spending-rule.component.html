<div id="device" class="page-layout carded fullwidth" fusePerfectScrollbar>

  <!-- TOP BACKGROUND -->
  <div class="top-bg mat-accent-bg"></div>
  <!-- / TOP BACKGROUND -->

  <!-- CENTER -->
  <div class="center">

    <!-- HEADER -->
    <div class="header white-fg" fxLayout="row" fxLayoutAlign="space-between center">

      <!-- APP TITLE -->
      <div fxLayout="row" fxLayoutAlign="start center">

        <div fxLayout="column" fxLayoutAlign="start start" *fuseIfOnDom>

          <div class="h2">
            {{'WALLET.MANUAL_BALANCE_ADJUSTMENT' | translate}}
          </div>


          <div class="subtitle secondary-text" *ngIf="false">
            <span>{{'USER.USER_DETAIL' | translate}}</span>
          </div>
        </div>
      </div>
      <!-- / APP TITLE -->
    </div>
    <!-- / HEADER -->

    <!-- CONTENT CARD -->
    <div class="content-card mat-white-bg">
      <form style="overflow-x: scroll" name="manualBalanceAdjustmentsForm" [formGroup]="settingsForm" class="user w-100-p"
        fxLayout="column" class="mat-white-bg p-24 m-24">

        <div class="mb-24" class="example-container" fxFlex="100" fxLayout="row wrap">
          <!-- BASIC SPENDING RULES STTRIBUTES -->
          <mat-form-field  fxFlex="100" fxFlex.gt-sm="50">
            <input matInput placeholder="{{ 'SPENDING_RULE.BUSINESS_ID'  | translate }}" formControlName="businessId"
              required>
          </mat-form-field>

          <mat-form-field fxFlex="100" fxFlex.gt-sm="50">
            <input matInput placeholder="{{ 'SPENDING_RULE.BUSINESS_NAME'  | translate }}" formControlName="businessName"
              required>
          </mat-form-field>

          <mat-form-field fxFlex="100" fxFlex.gt-sm="50">
            <input matInput placeholder="{{ 'SPENDING_RULE.MIN_OPERATION_AMOUNT'  | translate }}" formControlName="minOperationAmount"
              required type="number" >
          </mat-form-field>
          <!-- BASIC SPENDING RULES STTRIBUTES -->
        </div>


        <!-- SETTINGS BY PRODUCT -->
        <div fxFlex="100" fxLayout="column">
          <div fxFlex="100" fxLayoutAlign="center center">
            <span fxLayoutAlign="center center"> {{'SETTINGS.FARE_COLLECTOR_TITTLE' | translate}} </span>
          </div>
          <div fxFlex="100" fxLayout="row wrap">
            <div *ngFor="let item of settingsForm.get('utilitiesByProduct')['controls']; let i = index;" fxFlex="100"
              formArrayName="utilitiesByProduct">
              <div  [formGroupName]="i" fxFlex="100" fxLayout="row wrap">
                <mat-form-field class="pr-5 pl-5" fxFlex="100" fxFlex.gt-sm="23">
                  <input matInput formControlName="type" placeholder="{{'TYPE' | translate}}">
                </mat-form-field>
                <mat-form-field class="pr-5 pl-5" fxFlex="100" fxFlex.gt-sm="23">
                  <input matInput formControlName="concept" placeholder="{{'CONCEPT' | translate}}">
                </mat-form-field>
                <mat-form-field class="pr-5 pl-5" fxFlex="100" fxFlex.gt-sm="23">
                  <input type="number" matInput formControlName="percentageByMain" placeholder="{{'PERCETAGE_WITH_MAIN' | translate}}"
                    [value]="settingsForm.controls['utilitiesByProduct']['controls'][i].controls.percentageByMain.value">
                  <!-- value="{{  }}" -->
                </mat-form-field>
                <mat-form-field class="pr-5 pl-5" fxFlex="100" fxFlex.gt-sm="23">
                  <input type="number" matInput formControlName="percentageByCredit" placeholder="{{'PERCENTAGE_WITH_CREDIT' | translate}}"
                    [value]="settingsForm.controls['utilitiesByProduct']['controls'][i].controls.percentageByCredit.value">
                  <!-- value="{{  }}" -->
                </mat-form-field>
                <div *ngIf="currentVersion" fxFlex="100" fxFlex.gt-sm="8" fxLayoutAlign="center center">
                  <button mat-icon-button (click)="deleteControl('utilitiesByProduct', i)">
                    <mat-icon>delete</mat-icon>
                  </button>
                </div>

              </div>
            </div>
            <div fxFlex="100" fxLayoutAlign="center center">
              <button mat-icon-button (click)="addProductSetting()">
                <mat-icon>add</mat-icon>
              </button>
            </div>

          </div>
        </div>
        <!-- SETTINGS BY PRODUCT -->

        <!-- AUTOPOCKET SELLECTION SETTINGS -->
        <div class="marging-b-t-5 p-24" fxFlex="100" fxLayout="column">
          <div fxFlex="100" fxLayoutAlign="center center">
            <span fxLayoutAlign="center center"> {{'SETTINGS.FARE_COLLECTOR_TITTLE' | translate}} </span>
          </div>
          <div fxFlex="100" fxLayout="row wrap">
            <div *ngFor="let item of settingsForm.get('autoPocketSelectionRules')['controls']; let i = index;" fxFlex="100"
              formArrayName="autoPocketSelectionRules">
              <div [formGroupName]="i" fxFlex="100" fxLayout="row wrap">
                <!-- PRIORITY -->
                <mat-form-field class="pr-5 pl-5" fxFlex="100" fxFlex.gt-sm="10">
                  <input matInput type="number" formControlName="priority" placeholder="{{'PRIORITY' | translate}}">
                </mat-form-field>
                <!-- PRIORITY -->
                <!-- POCKET TO USE -->
                <mat-form-field class="pr-5 pl-5" fxFlex="100" fxFlex.gt-sm="20">
                  <input matInput formControlName="toUse" placeholder="{{'POCKET' | translate}}">
                </mat-form-field>
                <!-- POCKET TO USE -->

                <p fxFlex="100" fxFlex.gt-sm="15" class="pr-5 pl-5" style="text-align: center"> {{ 'WHEN' | translate}}
                </p>

                <!-- POCKET -->
                <mat-form-field class="pr-5 pl-5" fxFlex="100" fxFlex.gt-sm="20">
                  <input matInput formControlName="pocket" placeholder="{{'POCKET' | translate}}" [value]="settingsForm.controls['autoPocketSelectionRules']['controls'][i].controls.pocket.value">
                  <!-- value="{{  }}" -->
                </mat-form-field>
                <!-- POCKET -->
                <!-- COMPARATOR -->
                <mat-form-field class="pr-5 pl-5" fxFlex="100" fxFlex.gt-sm="10">
                  <input matInput formControlName="comparator" placeholder="{{'COMPARATOR' | translate}}" [value]="settingsForm.controls['autoPocketSelectionRules']['controls'][i].controls.comparator.value">
                  <!-- value="{{  }}" -->
                </mat-form-field>
                <!-- COMPARATOR -->
                <!-- VALUE -->
                <mat-form-field *ngIf="settingsForm.get('autoPocketSelectionRules')['controls'][0]['value']['comparator'] != 'ENOUGH'" class="pr-5 pl-5" fxFlex="100" fxFlex.gt-sm="20">
                  <input type="number" matInput formControlName="value" placeholder="{{'VALUE' | translate}}" [value]="settingsForm.controls['autoPocketSelectionRules']['controls'][i].controls.value.value">
                  <!-- value="{{  }}" -->
                </mat-form-field>
                <!-- VALUE -->

                <div *ngIf="currentVersion" class="pr-5 pl-5" fxFlex="100" fxFlex.gt-sm="5" fxLayoutAlign="center center">
                  <button mat-icon-button (click)="deleteControl('autoPocketSelectionRules', i)">
                    <mat-icon>delete</mat-icon>
                  </button>
                </div>
                <hr style="background: blue" fxFlex="100" fxHide.gt-sm="5" fxLayoutAlign="center center">


              </div>
            </div>
            <div fxFlex="100" fxLayoutAlign="center center">
              <button mat-icon-button (click)="addAutoPocketSelectionRule()">
                <mat-icon>add</mat-icon>
              </button>
            </div>

          </div>
        </div>
        <!-- AUTOPOCKET SELLECTION SETTINGS -->
        <div fxFlex="100" fxFlexLayout="row" fxLayoutAlign="space-around center" >

            <button mat-stroked-button  (click)="saveSpendingRule()">SAVE</button>
            <button mat-stroked-button color="primary" (click)="undoChanges()">UNDO CHANGES</button>

        </div>





        <!-- </div> -->
      </form>

      <!-- / CONTENT -->

    </div>
    <!-- / CONTENT CARD -->

  </div>
  <!-- / CENTER -->
</div>
